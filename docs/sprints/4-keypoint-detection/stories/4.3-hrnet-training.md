# Story 4.3: HRNet Training

**Status:** To Do
**Assignee:** U2 (Anton Shkrebela)
**Priority:** High
**Sprint:** 4 - Keypoint Detection

---

## Description

As an ML engineer, I want to train HRNet for dog facial keypoint detection.

---

## Acceptance Criteria

- [ ] HRNet-W32 configured for 20 keypoints
- [ ] Training script created
- [ ] Model trained with proper loss function
- [ ] Best checkpoint saved

---

## Tasks

- [ ] Set up HRNet architecture
- [ ] Configure for 20 output keypoints
- [ ] Implement MSE loss for keypoint regression
- [ ] Train with learning rate schedule
- [ ] Monitor validation PCK
- [ ] Save best model

---

## Training Configuration

```python
# Model: HRNet-W32
# Loss: MSE on heatmaps
# Input: 256x256
# Output: 20 heatmaps (64x64)

config = {
    'model': 'hrnet_w32',
    'num_keypoints': 20,
    'input_size': 256,
    'heatmap_size': 64,
    'sigma': 2,  # Gaussian sigma for heatmaps
    'epochs': 100,
    'batch_size': 32,
    'lr': 1e-3,
    'weight_decay': 1e-4
}
```

---

## Output

- `scripts/training/train_keypoints.py`
- `runs/keypoints/best.pt`
