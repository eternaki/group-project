# Story 4.4: Model Evaluation

**Status:** To Do
**Assignee:** U2 (Anton Shkrebela)
**Priority:** High
**Sprint:** 4 - Keypoint Detection

---

## Description

As an ML engineer, I want to evaluate keypoint detection accuracy.

---

## Acceptance Criteria

- [ ] PCK@0.1 calculated on test set
- [ ] PCK@0.1 > 75% achieved
- [ ] Per-keypoint accuracy analyzed
- [ ] Visualization of predictions created

---

## Tasks

- [ ] Implement PCK metric
- [ ] Evaluate on test set
- [ ] Calculate per-keypoint accuracy
- [ ] Visualize sample predictions
- [ ] Document failure cases

---

## Metrics

| Metric | Target | Actual |
|--------|--------|--------|
| PCK@0.1 | > 75% | TBD |
| PCK@0.2 | > 90% | TBD |
| Mean Error (px) | < 10 | TBD |

---

## PCK Definition

Percentage of Correct Keypoints (PCK) measures the percentage of predicted keypoints that fall within a threshold distance from ground truth, normalized by the bounding box size.

```python
def pck(pred, gt, bbox_size, threshold=0.1):
    dist = np.linalg.norm(pred - gt, axis=1)
    normalized = dist / bbox_size
    return np.mean(normalized < threshold)
```

---

## Output

- `docs/reports/keypoints-evaluation.md`
- `notebooks/keypoints_evaluation.ipynb`
