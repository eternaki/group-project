# Story 2.2: YOLOv8 Fine-tuning

**Status:** Done
**Completed:** 2025-01-16
**Assignee:** U3 (Danylo Zherzdiev)
**Priority:** High
**Sprint:** 2 - Dog Detection

---

## Description

As an ML engineer, I want to fine-tune YOLOv8 on dog detection so that the model accurately detects dogs in images.

---

## Acceptance Criteria

- [x] YOLOv8m base model loaded with pretrained weights
- [x] Training script created
- [x] Model trained for sufficient epochs
- [x] Training logs and metrics saved
- [x] Best checkpoint saved

---

## Tasks

- [x] Set up training environment with GPU
- [x] Create training script (scripts/training/train_bbox.py)
- [x] Configure hyperparameters
- [x] Run training
- [x] Monitor training with TensorBoard/W&B
- [x] Select best checkpoint based on val mAP

---

## Training Configuration

```python
from ultralytics import YOLO

model = YOLO('yolov8m.pt')

results = model.train(
    data='data/bbox_training/dataset.yaml',
    epochs=100,
    imgsz=640,
    batch=16,
    device=0,
    workers=8,
    patience=20,
    save=True,
    project='runs/bbox',
    name='yolov8m_dogs'
)
```

---

## Hyperparameters

| Parameter | Value | Notes |
|-----------|-------|-------|
| epochs | 100 | With early stopping |
| batch_size | 16 | Adjust based on GPU memory |
| imgsz | 640 | Standard YOLO input size |
| lr0 | 0.01 | Initial learning rate |
| lrf | 0.01 | Final LR (lr0 * lrf) |
| momentum | 0.937 | SGD momentum |
| weight_decay | 0.0005 | L2 regularization |
| patience | 20 | Early stopping patience |

---

## Expected Output

```
runs/bbox/yolov8m_dogs/
├── weights/
│   ├── best.pt
│   └── last.pt
├── results.csv
├── confusion_matrix.png
└── results.png
```

---

## Output

- `scripts/training/train_bbox.py`
- `runs/bbox/yolov8m_dogs/weights/best.pt`
