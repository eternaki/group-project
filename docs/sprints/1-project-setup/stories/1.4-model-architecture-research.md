# Story 1.4: Model Architecture Research

**Status:** Done
**Completed:** 2025-01-16
**Assignee:** U2 (Anton Shkrebela), U3 (Danylo Zherzdiev)
**Priority:** High
**Sprint:** 1 - Project Setup

---

## Description

As an ML engineer, I want to research state-of-the-art models so that I choose the best architectures for each task.

---

## Acceptance Criteria

- [x] YOLOv8 capabilities documented for dog detection
- [x] HRNet evaluated for keypoint detection
- [x] ViT vs EfficientNet compared for breed classification
- [x] Emotion classifier architecture decided
- [x] Final architecture decisions documented

---

## Tasks

- [x] Research YOLOv8 variants (n, s, m, l, x)
- [x] Research HRNet variants (W18, W32, W48)
- [x] Compare ViT-B/16 vs EfficientNet-B4
- [x] Design emotion classifier (MLP vs CNN)
- [x] Estimate inference speed for each
- [x] Write architecture decision document

---

## Models to Evaluate

### Dog Detection (BBox)

| Model | mAP (COCO) | Speed | Size |
|-------|------------|-------|------|
| YOLOv8n | 37.3 | Fast | 3.2M |
| YOLOv8s | 44.9 | Fast | 11.2M |
| YOLOv8m | 50.2 | Medium | 25.9M |
| YOLOv8l | 52.9 | Slow | 43.7M |

**Recommendation:** YOLOv8m (balance of accuracy and speed)

### Keypoint Detection

| Model | PCK@0.5 | Speed | Size |
|-------|---------|-------|------|
| HRNet-W18 | Good | Fast | 9.3M |
| HRNet-W32 | Better | Medium | 28.5M |
| HRNet-W48 | Best | Slow | 63.6M |

**Recommendation:** HRNet-W32

### Breed Classification

| Model | Top-1 Acc | Speed | Size |
|-------|-----------|-------|------|
| ViT-B/16 | 85% | Medium | 86M |
| EfficientNet-B4 | 83% | Fast | 19M |
| ResNet-50 | 79% | Fast | 25M |

**Recommendation:** EfficientNet-B4 (good accuracy, fast)

### Emotion Classification

| Model | Notes |
|-------|-------|
| MLP (3 layers) | Simple, fast, uses keypoint features |
| Small CNN | Can use cropped face image |

**Recommendation:** MLP on keypoint features

---

## Output

- `docs/plans/2025-01-16-model-architecture-decisions.md` âœ…
