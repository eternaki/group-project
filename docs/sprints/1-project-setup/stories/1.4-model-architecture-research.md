# Story 1.4: Model Architecture Research

**Status:** To Do
**Assignee:** U2 (Anton Shkrebela), U3 (Danylo Zherzdiev)
**Priority:** High
**Sprint:** 1 - Project Setup

---

## Description

As an ML engineer, I want to research state-of-the-art models so that I choose the best architectures for each task.

---

## Acceptance Criteria

- [ ] YOLOv8 capabilities documented for dog detection
- [ ] HRNet evaluated for keypoint detection
- [ ] ViT vs EfficientNet compared for breed classification
- [ ] Emotion classifier architecture decided
- [ ] Final architecture decisions documented

---

## Tasks

- [ ] Research YOLOv8 variants (n, s, m, l, x)
- [ ] Research HRNet variants (W18, W32, W48)
- [ ] Compare ViT-B/16 vs EfficientNet-B4
- [ ] Design emotion classifier (MLP vs CNN)
- [ ] Estimate inference speed for each
- [ ] Write architecture decision document

---

## Models to Evaluate

### Dog Detection (BBox)

| Model | mAP (COCO) | Speed | Size |
|-------|------------|-------|------|
| YOLOv8n | 37.3 | Fast | 3.2M |
| YOLOv8s | 44.9 | Fast | 11.2M |
| YOLOv8m | 50.2 | Medium | 25.9M |
| YOLOv8l | 52.9 | Slow | 43.7M |

**Recommendation:** YOLOv8m (balance of accuracy and speed)

### Keypoint Detection

| Model | PCK@0.5 | Speed | Size |
|-------|---------|-------|------|
| HRNet-W18 | Good | Fast | 9.3M |
| HRNet-W32 | Better | Medium | 28.5M |
| HRNet-W48 | Best | Slow | 63.6M |

**Recommendation:** HRNet-W32

### Breed Classification

| Model | Top-1 Acc | Speed | Size |
|-------|-----------|-------|------|
| ViT-B/16 | 85% | Medium | 86M |
| EfficientNet-B4 | 83% | Fast | 19M |
| ResNet-50 | 79% | Fast | 25M |

**Recommendation:** EfficientNet-B4 (good accuracy, fast)

### Emotion Classification

| Model | Notes |
|-------|-------|
| MLP (3 layers) | Simple, fast, uses keypoint features |
| Small CNN | Can use cropped face image |

**Recommendation:** MLP on keypoint features

---

## Output

- `docs/plans/model-architecture-decisions.md`
